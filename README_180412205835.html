<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>README.md—C:\xampp\devdocker</title>
    <style type="text/css">
    body{font-family:Helvetica,arial,sans-serif;font-size:14px;line-height:1.6;padding-top:10px;padding-bottom:10px;background-color:white;padding:30px;color:#333}body>*:first-child{margin-top:0!important}body>*:last-child{margin-bottom:0!important}a{color:#4183c4;text-decoration:none}a:hover{text-decoration:underline}a.absent{color:#c00}a.anchor{display:block;padding-left:30px;margin-left:-30px;cursor:pointer;position:absolute;top:0;left:0;bottom:0}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0}kbd{background:#f1f1f1;background:-moz-linear-gradient(#f1f1f1,#ddd);background:-webkit-linear-gradient(#f1f1f1,#ddd);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr='#f1f1f1', endColorstr='#dddddd')";border-radius:2px;border:1px solid #ddd;border-bottom-color:#ccc;border-right-color:#ccc;padding:1px 4px;line-height:10px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.container{max-width:920px;margin:0 auto 20px auto}#header{background:#fafafa;background:-moz-linear-gradient(#fafafa,#eaeaea);background:-webkit-linear-gradient(#fafafa,#eaeaea);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr='#fafafa', endColorstr='#eaeaea')";border-bottom:1px solid #cacaca;box-shadow:0 1px 0 rgba(255,255,255,0.4),0 0 10px rgba(0,0,0,0.1)}#markup{padding:3px}#markup article{padding-top:30px}.markdown-body{font-size:14px;line-height:1.6}.markdown-body>*:first-child{margin-top:0!important}.markdown-body>*:last-child{margin-bottom:0!important}.markdown-body a.absent{color:#c00}.markdown-body a.anchor{bottom:0;cursor:pointer;display:block;left:0;margin-left:-30px;padding-left:30px;position:absolute;top:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{cursor:text;font-weight:bold;margin:20px 0 10px;padding:0;position:relative}.markdown-body h1 .mini-icon-link,.markdown-body h2 .mini-icon-link,.markdown-body h3 .mini-icon-link,.markdown-body h4 .mini-icon-link,.markdown-body h5 .mini-icon-link,.markdown-body h6 .mini-icon-link{color:#000;display:none}.markdown-body h1:hover a.anchor,.markdown-body h2:hover a.anchor,.markdown-body h3:hover a.anchor,.markdown-body h4:hover a.anchor,.markdown-body h5:hover a.anchor,.markdown-body h6:hover a.anchor{line-height:1;margin-left:-22px;padding-left:0;text-decoration:none;top:15%}.markdown-body h1:hover a.anchor .mini-icon-link,.markdown-body h2:hover a.anchor .mini-icon-link,.markdown-body h3:hover a.anchor .mini-icon-link,.markdown-body h4:hover a.anchor .mini-icon-link,.markdown-body h5:hover a.anchor .mini-icon-link,.markdown-body h6:hover a.anchor .mini-icon-link{display:inline-block}.markdown-body h1 tt,.markdown-body h1 code,.markdown-body h2 tt,.markdown-body h2 code,.markdown-body h3 tt,.markdown-body h3 code,.markdown-body h4 tt,.markdown-body h4 code,.markdown-body h5 tt,.markdown-body h5 code,.markdown-body h6 tt,.markdown-body h6 code{font-size:inherit}.markdown-body h1{color:#000;font-size:28px}.markdown-body h2{border-bottom:1px solid #ccc;color:#000;font-size:24px}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h6{color:#777;font-size:14px}.markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body dl,.markdown-body table,.markdown-body pre{margin:15px 0}.markdown-body hr{background:url("/public/github-dirty-shade.png") repeat-x scroll 0 0 transparent;border:0 none;color:#ccc;height:4px;padding:0}.markdown-body>h2:first-child,.markdown-body>h1:first-child,.markdown-body>h1:first-child+h2,.markdown-body>h3:first-child,.markdown-body>h4:first-child,.markdown-body>h5:first-child,.markdown-body>h6:first-child{margin-top:0;padding-top:0}.markdown-body a:first-child h1,.markdown-body a:first-child h2,.markdown-body a:first-child h3,.markdown-body a:first-child h4,.markdown-body a:first-child h5,.markdown-body a:first-child h6{margin-top:0;padding-top:0}.markdown-body h1+p,.markdown-body h2+p,.markdown-body h3+p,.markdown-body h4+p,.markdown-body h5+p,.markdown-body h6+p{margin-top:0}.markdown-body li p.first{display:inline-block}.markdown-body ul,.markdown-body ol{padding-left:30px}.markdown-body ul.no-list,.markdown-body ol.no-list{list-style-type:none;padding:0}.markdown-body ul li>*:first-child,.markdown-body ol li>*:first-child{margin-top:0}.markdown-body ul ul,.markdown-body ul ol,.markdown-body ol ol,.markdown-body ol ul{margin-bottom:0}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:14px;font-style:italic;font-weight:bold;margin:15px 0 5px;padding:0}.markdown-body dl dt:first-child{padding:0}.markdown-body dl dt>*:first-child{margin-top:0}.markdown-body dl dt>*:last-child{margin-bottom:0}.markdown-body dl dd{margin:0 0 15px;padding:0 15px}.markdown-body dl dd>*:first-child{margin-top:0}.markdown-body dl dd>*:last-child{margin-bottom:0}.markdown-body blockquote{border-left:4px solid #ddd;color:#777;padding:0 15px}.markdown-body blockquote>*:first-child{margin-top:0}.markdown-body blockquote>*:last-child{margin-bottom:0}.markdown-body table{border-collapse:collapse;border-spacing:0}.markdown-body table th{font-weight:bold}.markdown-body table th,.markdown-body table td{border:1px solid #ccc;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#f8f8f8;border:1px solid #eaeaea;border-radius:3px 3px 3px 3px;margin:0 2px;padding:0 5px;white-space:nowrap}.markdown-body pre>code{background:none repeat scroll 0 0 transparent;border:medium none;margin:0;padding:0;white-space:pre}.markdown-body .highlight pre,.markdown-body pre{background-color:#f8f8f8;border:1px solid #ccc;border-radius:3px 3px 3px 3px;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px}.markdown-body pre code,.markdown-body pre tt{background-color:transparent;border:medium none}.codehilite{background:#fff}.codehilite .c{color:#998;font-style:italic}.codehilite .err{color:#a61717;background-color:#e3d2d2}.codehilite .k{color:#000;font-weight:bold}.codehilite .o{color:#000;font-weight:bold}.codehilite .cm{color:#998;font-style:italic}.codehilite .cp{color:#999;font-weight:bold}.codehilite .c1{color:#998;font-style:italic}.codehilite .cs{color:#999;font-weight:bold;font-style:italic}.codehilite .gd{color:#000;background-color:#fdd}.codehilite .gd .x{color:#000;background-color:#faa}.codehilite .ge{color:#000;font-style:italic}.codehilite .gr{color:#a00}.codehilite .gh{color:#999}.codehilite .gi{color:#000;background-color:#dfd}.codehilite .gi .x{color:#000;background-color:#afa}.codehilite .go{color:#888}.codehilite .gp{color:#555}.codehilite .gs{font-weight:bold}.codehilite .gu{color:#aaa}.codehilite .gt{color:#a00}.codehilite .kc{color:#000;font-weight:bold}.codehilite .kd{color:#000;font-weight:bold}.codehilite .kp{color:#000;font-weight:bold}.codehilite .kr{color:#000;font-weight:bold}.codehilite .kt{color:#458;font-weight:bold}.codehilite .m{color:#099}.codehilite .s{color:#d14}.codehilite .na{color:#008080}.codehilite .nb{color:#0086b3}.codehilite .nc{color:#458;font-weight:bold}.codehilite .no{color:#008080}.codehilite .ni{color:#800080}.codehilite .ne{color:#900;font-weight:bold}.codehilite .nf{color:#900;font-weight:bold}.codehilite .nn{color:#555}.codehilite .nt{color:#000080}.codehilite .nv{color:#008080}.codehilite .ow{color:#000;font-weight:bold}.codehilite .w{color:#bbb}.codehilite .mf{color:#099}.codehilite .mh{color:#099}.codehilite .mi{color:#099}.codehilite .mo{color:#099}.codehilite .sb{color:#d14}.codehilite .sc{color:#d14}.codehilite .sd{color:#d14}.codehilite .s2{color:#d14}.codehilite .se{color:#d14}.codehilite .sh{color:#d14}.codehilite .si{color:#d14}.codehilite .sx{color:#d14}.codehilite .sr{color:#009926}.codehilite .s1{color:#d14}.codehilite .ss{color:#990073}.codehilite .bp{color:#999}.codehilite .vc{color:#008080}.codehilite .vg{color:#008080}.codehilite .vi{color:#008080}.codehilite .il{color:#099}
    </style>
    <style type="text/css">
      .markdown-body hr{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC")}
    </style>
  </head>
  <body>
    <div class="container">
      <div id="markup">
        <article id="content" class="markdown-body">
          <h1 id="docker">Docker相关文档</h1>
<p>2018.3.19 苏乃文</p>
<h1 id="winodwsmacdocker">Winodws、MAC的docker配置文档</h1>
<h3 id="1">1. 安装</h3>
<p>安装Docker for Windows 或 Dokcer for Mac。网盘里或者自己去docker官网下载。</p>
<p>具体可以参考<code>文档</code>文件夹里的<code>docker从入门到实践.pdf</code>。</p>
<p>要注意的是你的<code>localhost</code>所能访问的文件夹是和<code>devdocker</code>平级的<code>wwwroot</code>文件夹。也就是典型的目录结构是：</p>
<div class="codehilite"><pre>./devdocker/ ./wwwroot/
</pre></div>


<p>然后<code>./wwwroot/</code>里是：</p>
<div class="codehilite"><pre>./xy/ ./web/ ./earth/ 等
</pre></div>


<p>注意：如果你已经安装xampp，请把<code>devdocker</code>放到<code>htdocs</code>平级的地方，也就是<code>c:\xampp</code>目录底下。然后你看你的方便，是改<code>.env</code>文件里的<code>APPLICATION</code>位置还是创建<code>wwwroot</code>文件夹（建议用后者）。如果你没有安装xampp，那么理论上你可以随便放。</p>
<h3 id="2">2. 配置加速器镜像</h3>
<p>右击托盘上的 小鲸鱼 ，选中 Settings选项，会打开设置窗口，选中 Daemon ，在 Registry mirrors的输入框内，输入：</p>
<div class="codehilite"><pre>https://urpvm08q.mirror.aliyuncs.com
https://registry.docker-cn.com
</pre></div>


<p>最后点击 Apply。</p>
<h3 id="3-devdocker">3. 跑起来我们的镜像devdocker</h3>
<p>（注：运行前，请确认类似 xampp 的软件已关闭 80、3306、6379端口未被占用）</p>
<p>（注：执行过程中，docker程序会弹出弹窗，询问是否共享，请选择 share it 选项）</p>
<p>请执行下面的4、11步骤。（可以使用cmd或者windwos shell或者git bash）</p>
<h1 id="linuxdocker">Linux的docker配置文档</h1>
<p>其他系统的安装请查阅：https://www.gitbook.com/book/yeasy/docker_practice/details</p>
<h3 id="1_1">1. 查看系统版本</h3>
<div class="codehilite"><pre>cat /etc/os-release
</pre></div>


<h3 id="2-git">2. 安装Git</h3>
<div class="codehilite"><pre>yum -y install git
</pre></div>


<h3 id="3-git">3. 配置Git公钥</h3>
<ol>
<li>
<p>设置用户名和邮箱（下面dev处可以换成自己的名字、邮箱）</p>
<div class="codehilite"><pre>git config --global user.name &quot;dev&quot;
git config --global user.email &quot;dev@xingyunbooks.com&quot;
</pre></div>


</li>
<li>
<p>生成秘钥和公钥（默认目录和空密码，三个回车）（下面dev处可以换成自己的名字、邮箱）</p>
<div class="codehilite"><pre>ssh-keygen -t rsa -C &quot; dev@xingyunbooks.com&quot;
</pre></div>


</li>
<li>
<p>查看公钥并复制到阿里git仓库的ssh key中</p>
<div class="codehilite"><pre>cat ~/.ssh/id_rsa.pub
</pre></div>


</li>
</ol>
<h3 id="4-docker-compose-file">4. 将docker-compose file克隆到本地</h3>
<p>因习惯，将其克隆到 <code>/data /</code> 目录下。</p>
<p>注意：如果是开发环境下，请把<code>devdocker</code>放到<code>htdocs</code>平级的地方，也就是<code>c:\xampp</code>目录底下。</p>
<div class="codehilite"><pre>mkdir /data/    
cd /data/
git clone git@code.aliyun.com:xy/devdocker.git
</pre></div>


<h3 id="5-yum-yum">5. 安装依赖，配置国内的 yum 源，更新yum软件源缓存</h3>
<p>docker的前置安装软件</p>
<div class="codehilite"><pre>yum install -y yum-utils device-mapper-persistent-data lvm2
yum-config-manager --add-repo https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo
yum makecache fast
</pre></div>


<h3 id="6-docker">6. 安装 docker</h3>
<div class="codehilite"><pre>yum install -y docker-ce            //  若有询问，全部填 y
</pre></div>


<h3 id="7-todo-docker-docker">7. TODO：建立 docker 用户组，并把用户添加进docker用户组。</h3>
<h3 id="8-dockerdocker">8. 添加国内docker镜像加速器，加载配置，并重启docker</h3>
<div class="codehilite"><pre>systemctl restart docker

//下面这一段（包含结束于EOF）要一起复制粘贴：
tee /etc/docker/daemon.json &lt;&lt;-&#39;EOF&#39;
{
    &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;,&quot;https://urpvm08q.mirror.aliyuncs.com&quot;]
}
EOF


systemctl daemon-reload
systemctl restart docker
</pre></div>


<h3 id="9">9. 可选：检查加速器是否生效</h3>
<p>配置加速器之后，如果拉取镜像仍然十分缓慢，请手动检查加速器配置是否生效，在命令行执行</p>
<div class="codehilite"><pre>docker info
</pre></div>


<p>如果从结果中看到了如下内容，说明配置成功。</p>
<div class="codehilite"><pre>Registry Mirrors:
https://registry.docker-cn.com/
</pre></div>


<h3 id="10-docker-compose">10. 安装docker-compose</h3>
<p>神奇的问题是下面这句话第一遍一般超时，第二遍才好</p>
<div class="codehilite"><pre>sudo curl -L https://github.com/docker/compose/releases/download/1.19.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose;
sudo chmod +x /usr/local/bin/docker-compose;
docker-compose --version;
</pre></div>


<h3 id="11-laradock">11. 运行Laradock</h3>
<p>进入docker环境目录</p>
<div class="codehilite"><pre>cd devdocker/
</pre></div>


<p>下面的运行会出现warning。（有黄色的、红色的）可以忽略。
第一次运行需要安装环境，需要比较久的时间，请耐心等待</p>
<div class="codehilite"><pre>docker-compose up -d nginx mysql redis
</pre></div>


<p>至此，docker已经安装完毕。接下来开始部署。</p>
<h3 id="12">12. 准备部署脚本</h3>
<div class="codehilite"><pre>cd ~;
rm -rf ~/autoshell/;
git clone git@code.aliyun.com:xy/autoshell.git
chmod u+x ./autoshell/*;
cd ~/autoshell/;
</pre></div>


<h3 id="13">13. 运行部署脚本</h3>
<p>ALL OVER。</p>
<h1 id="docker_1">docker相关知识、命令快速说明</h1>
<h2 id="laradock">启动laradock</h2>
<p>可以根据自己需要自行启动 nginx/apache/mysql/phpmyadmin/redis 等</p>
<p>注：</p>
<div class="codehilite"><pre>phpmyadmin 请访问 http://IP:88
pgadmin请访问 http://IP:5050
</pre></div>


<h2 id="_1">常用操作</h2>
<p>以下操作请确保在laradock 根目录下</p>
<h4 id="_2">启动相关</h4>
<p>laradock 默认会启动 php-fpm 和 workspace ，所以参数中无需加这两个。</p>
<p>后台启动</p>
<div class="codehilite"><pre>docker-compose up -d xxxxxx
</pre></div>


<p>只重启nginx （比如修改了配置文件）</p>
<div class="codehilite"><pre>docker-compose restart nginx
</pre></div>


<p>停止所有</p>
<div class="codehilite"><pre>docker-compose stop
</pre></div>


<p>重新构建相应的容器</p>
<div class="codehilite"><pre>docker-compose build nginx worksapce
</pre></div>


<h4 id="_3">工作空间</h4>
<p>进入工作空间前，请确认环境已经启动</p>
<div class="codehilite"><pre>docker-compose exec workspace bash
</pre></div>


<p>会进入 /var/www 目录</p>
<p>此时 可以执行composer 和PHP命令。</p>
<p>如果之前env-example 开启了node和yarn 也可执行对应命令。</p>
<h4 id="php">连接数据库和PHP</h4>
<p>请一定注意，数据库连接地址请一定填写为mysql、postgres、mariadb 等。</p>
<p>另外Nginx/Caddy/Apache 如果需要访问PHP容器，请填写:php-fpm</p>
<h4 id="laradock_1">更改laradock 配置</h4>
<p>当你再次修改完env-example 后，请一定按照如下方法执行：</p>
<div class="codehilite"><pre>cp env-example .env
</pre></div>


<p>重新构建相应的容器</p>
<div class="codehilite"><pre>docker-compose build nginx worksapce
</pre></div>


<p>如果还修改了 其他容器配置，请在后面一同加上</p>
<p>需要注意的是：</p>
<p>由于数据库的数据是映射到宿主机目录的，所以在env-example中修改数据库密码，即使重新构建也无效。如需强制更改请删除数据存储处里面对应数据库的数据。</p>
<p>日常修改密码，请使用phpmyadmin 或者 pgadmin</p>
<h1 id="_4">特别说明（以下基本不用看，因为都已经设置好了)</h1>
<h3 id="1_2">1. 数据库相关：</h3>
<p>由于容器之间的互联，数据库配置中的 “DB_HOST”值只能填mysql。</p>
<p>数据库默认账号密码：账号-root；密码-root。</p>
<p>在数据库中新建用户时，用户的登录授权端，需要填%，否则不能没有权限登录</p>
<div class="codehilite"><pre>CREATE USER &#39;xyName342h&#39;@&#39;%&#39; IDENTIFIED BY &#39;fds77GHkzH8&#39;;
</pre></div>


<p>TODO：可以尝试当%换成mysql域会如何？</p>
<h3 id="2-docker">2. 命令解析（以下所有命令都必须在docker配置文档的根目录执行）</h3>
<ol>
<li>
<p>进入容器内部</p>
<div class="codehilite"><pre>docker-compose exec [mysql/reids/nginx/workspace] bash
</pre></div>


</li>
<li>
<p>操作容器</p>
</li>
</ol>
<p>每次修改了容器的配置文件，都需要重新构建容器，并重新启动</p>
<p>构建：（不指定容器，默认构建全部）</p>
<div class="codehilite"><pre>docker-compose build nginx mysql redis
</pre></div>


<p>后台运行：下面的命令，如果指定的容器尚未构建，则会先构建，再启动</p>
<div class="codehilite"><pre>docker-compose up –d nginx
</pre></div>


<p>启动容器（不管有这个容器有没有构建，都会启动，但是只有存在实体的容器会被真正启动）。推荐使用 up –d 运行容器</p>
<div class="codehilite"><pre>docker-compose start nginx php-fpm workspace
</pre></div>


<p>停止容器</p>
<div class="codehilite"><pre>docker-compose stop nginx mysql redis
</pre></div>


<p>其他命令：可在 http://laradock.io/ 查看</p>
<h3 id="3-devdockerdocker">3. 文件位置说明（<code>devdocker</code>表示docker配置的根目录）</h3>
<ol>
<li>Nginx 配置文件 ：<code>devdocker</code>\nginx\sites\default.conf</li>
<li>MySQL 配置文件：<code>devdocker</code>\mysql\my.cnf</li>
<li>PHP 配置文档：<code>devdocker</code>\php-fpm\php**.ini（由.env文件中的PHP_VERSION=56 确定选择的配置文件）</li>
</ol>
<h3 id="4-env-cp-env-example-env">4. <code>.env</code> 配置文件说明（如果没有，可以 <code>cp env-example .env</code> 复制一份）</h3>
<ol>
<li>
<p>设置项目的映射目录，以当前文件所在目录为基础目录。以下设置的意思是：将docker配置文件夹同级的所有文件，都映射到容器中，实现共享</p>
<div class="codehilite"><pre>APPLICATION=../
</pre></div>


<p>特别说明：nginx 的default.conf 文件，决定nginx 默认访问的路径。</p>
<div class="codehilite"><pre>server {
    listen 80 default_server;
    listen [::]:80 default_server ipv6only=on;
    server_name localhost;
    root /var/www;（表示上面APPLICATION 映射的目录，只可向后添加路径）
    index index.php index.html index.htm;
    。。。。。。
}
</pre></div>


</li>
<li>
<p>设置 PHP 的扩展
在 PHP_FPM 中，将根据想要的扩展设置为true
例如：PHP_FPM_INSTALL_PHPREDIS=true</p>
</li>
<li>
<p>设置 NGINX 映射端口
指定宿主机映射到容器内的接口；其他接口设置，都是如此</p>
<div class="codehilite"><pre>NGINX_HOST_HTTP_PORT=80
</pre></div>


</li>
<li>
<p>设置时区</p>
<div class="codehilite"><pre>WORKSPACE_TIMEZONE=Asia/Shanghai
</pre></div>


</li>
</ol>
<h1 id="_5">参考文献：</h1>
<ol>
<li><a href="https://zhuanlan.zhihu.com/p/27182216">https://zhuanlan.zhihu.com/p/27182216</a></li>
</ol>
        </article>
      </div>
    </div>
  </body>
</html>
